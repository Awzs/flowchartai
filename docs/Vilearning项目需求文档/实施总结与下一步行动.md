# ViLearning å¤šDisplayå¹³å°å®æ–½æ€»ç»“ä¸ä¸‹ä¸€æ­¥è¡ŒåŠ¨

## ğŸ“‹ æ ¸å¿ƒæ–¹æ¡ˆæ€»ç»“

### æˆ˜ç•¥å®šä½
**å¿«é€ŸéªŒè¯ + æ¨¡å—åŒ–æ¼”è¿›** - å…ˆç¡¬ç¼–ç å®ç°æ€ç»´å¯¼å›¾éªŒè¯ä»·å€¼ï¼Œå†é‡æ„ä¸ºå¯æ‰©å±•æ¶æ„

### æŠ€æœ¯è·¯çº¿å›¾ (10å‘¨å®Œæˆ)
```
Week 1-2: æ€ç»´å¯¼å›¾Displayç¡¬ç¼–ç å®ç° (å¿«é€ŸéªŒè¯)
Week 3-4: æ•°æ®åº“æ¿€è¿›é‡æ„ (boards + displayså…³ç³»è¡¨)
Week 5-6: DisplayRegistryæ¶æ„ (å¤šDisplayåº•åº§)
Week 7-8: ä¸Šä¸‹æ–‡å·¥ç¨‹æµ…å±‚å®ç° (é€‰åŒº/é¡¹ç›®ä¸Šä¸‹æ–‡)
Week 9-10: æµ‹éªŒæ¨¡å—ç‹¬ç«‹é¢æ¿ (ç±»Ankiå­¦ä¹ )
```

---

## ğŸ¯ å…³é”®è®¾è®¡å†³ç­–

### 1. DisplayRegistry - æ’ä»¶åŒ–æ¶æ„
```typescript
// æ¯ä¸ªDisplayæ˜¯ä¸€ä¸ª"æ’ä»¶"
interface DisplayDefinition {
  type: 'flowchart' | 'mindmap' | 'quiz';
  schema: ZodSchema;           // æ•°æ®æ ¡éªŒ
  prompt: DisplayPrompt;       // Prompté…ç½®
  renderer: ComponentType;     // æ¸²æŸ“ç»„ä»¶
  exporter: ExportStrategy;    // å¯¼å‡ºç­–ç•¥
}

// ä¼˜åŠ¿: æ–°å¢Displayåªéœ€æ³¨å†Œï¼Œæ— éœ€ä¿®æ”¹æ ¸å¿ƒä»£ç 
```

### 2. æ•°æ®åº“æ¿€è¿›é‡æ„
```sql
boards (å·¥ä½œæ¿) 1:N displays (å…·ä½“å†…å®¹) 1:N contexts (ä¸Šä¸‹æ–‡)
```

**ä¸ºä»€ä¹ˆé€‰æ‹©æ¿€è¿›æ–¹æ¡ˆï¼Ÿ**
- é•¿æœŸå¯ç»´æŠ¤æ€§å¼º
- æ”¯æŒå¤šDisplayå¹¶å­˜
- ä¸Šä¸‹æ–‡å·¥ç¨‹å¤©ç„¶å‹å¥½
- è™½ç„¶è¿ç§»å¤æ‚ï¼Œä½†ä¸€æ¬¡æå®š

### 3. ä¸Šä¸‹æ–‡å·¥ç¨‹åˆ†ä¸¤é˜¶æ®µ
**æµ…å±‚ (Week 7-8)**
- âœ… é€‰åŒºä¸Šä¸‹æ–‡è‡ªåŠ¨é‡‡é›†
- âœ… Tokenæ§åˆ¶ (1500é™åˆ¶)
- âœ… ä¼˜å…ˆçº§æ’åº (é€‰åŒº > æœ€æ–° > é¡¹ç›®)

**æ·±å±‚ (åç»­)**
- ğŸ“ é¡¹ç›®çº§çŸ¥è¯†å›¾è°±
- ğŸ“ è·¨Displayå…³è”
- ğŸ“ åˆ†æ”¯è¿½æº¯

### 4. æ€ç»´å¯¼å›¾æŠ€æœ¯é€‰å‹: mind-elixir
**åŸå› :**
- âœ… MITè®¸å¯è¯ (å•†ä¸šå‹å¥½)
- âœ… è½»é‡çº§ (gzip ~50KB)
- âœ… åŠŸèƒ½å®Œæ•´ (æ‹–æ‹½ã€ç¼©æ”¾ã€å¯¼å‡º)
- âœ… Reactå‹å¥½

### 5. æµ‹éªŒæ¨¡å—: ç‹¬ç«‹å­¦ä¹ é¢æ¿
**ç‰¹ç‚¹:**
- ç±»ä¼¼Ankiçš„é—´éš”é‡å¤ç®—æ³•
- ç‹¬ç«‹äºç™½æ¿çš„å­¦ä¹ ç•Œé¢
- è¿›åº¦è·Ÿè¸ªä¸ç»Ÿè®¡
- Markdown/CSVå¯¼å‡º

---

## ğŸ“Š å…³é”®æ•°æ®æ¨¡å‹

### boards è¡¨ (å·¥ä½œæ¿)
```sql
- id: UUID (ä¸»é”®)
- user_id: UUID (å…³è”ç”¨æˆ·)
- title: VARCHAR(255) (æ ‡é¢˜)
- description: TEXT (æè¿°)
- display_type: VARCHAR(50) (ä¸»ç±»å‹: flowchart/mindmap/quiz/mixed)
```

### displays è¡¨ (å†…å®¹å•å…ƒ)
```sql
- id: UUID (ä¸»é”®)
- board_id: UUID (å…³è”å·¥ä½œæ¿)
- display_type: VARCHAR(50) (ç±»å‹)
- excalidraw_data: JSONB (ç™½æ¿åŸå§‹æ•°æ®)
- structured_payload: JSONB (ç»“æ„åŒ–æ•°æ®)
- ai_snapshot: JSONB (AIåŸå§‹è¾“å‡º)
- position_x/y/width/height: å¸ƒå±€ä¿¡æ¯
```

### contexts è¡¨ (ä¸Šä¸‹æ–‡å­˜å‚¨)
```sql
- id: UUID (ä¸»é”®)
- board_id: UUID (å…³è”å·¥ä½œæ¿)
- context_type: VARCHAR(50) (ç±»å‹: selection/project/conversation)
- context_value: JSONB (ä¸Šä¸‹æ–‡å†…å®¹)
- token_count: INTEGER (Tokenè®¡æ•°)
- expires_at: TIMESTAMP (è¿‡æœŸæ—¶é—´)
```

---

## ğŸš€ ç¬¬ä¸€é˜¶æ®µè¡ŒåŠ¨è®¡åˆ’ (Week 1-2)

### ç›®æ ‡
åœ¨ç°æœ‰æ¶æ„ä¸Š**ç¡¬ç¼–ç **å®ç°æ€ç»´å¯¼å›¾Displayï¼Œå¿«é€ŸéªŒè¯å¤šDisplayä»·å€¼

### å…³é”®ä»»åŠ¡

#### Day 1-3: æ€ç»´å¯¼å›¾åº“é€‰å‹ä¸é›†æˆ
```bash
# 1. å®‰è£…mind-elixir
pnpm add mind-elixir mind-elixir-react

# 2. åˆ›å»ºMindMapDisplayç»„ä»¶
touch src/components/displays/MindMapDisplay.tsx

# 3. åŸºç¡€æ¸²æŸ“æµ‹è¯•
# éªŒè¯åº“çš„åŸºæœ¬åŠŸèƒ½
```

#### Day 4-7: AIç”Ÿæˆé“¾è·¯
```typescript
// æ–°å¢è·¯ç”±: /api/ai/chat/mindmap
// ç±»ä¼¼ç°æœ‰flowchartè·¯ç”±ï¼Œä½†è¾“å‡ºæ€ç»´å¯¼å›¾JSON
```

**Promptæ¨¡æ¿ (å‚è€ƒæµç¨‹å›¾):**
```
ä½ æ˜¯ä¸€ä¸ªæ€ç»´å¯¼å›¾ç”Ÿæˆä¸“å®¶ã€‚
è¯·å°†ç”¨æˆ·è¾“å…¥è½¬æ¢ä¸ºå±‚çº§æ€ç»´å¯¼å›¾ã€‚

è¦æ±‚:
1. è¾“å‡ºä¸¥æ ¼çš„JSONæ ¼å¼
2. æ ¹èŠ‚ç‚¹æ˜ç¡®
3. å­èŠ‚ç‚¹å±‚çº§æ¸…æ™°
4. æ¯ä¸ªèŠ‚ç‚¹æ–‡å­—ç®€æ´ (<20å­—)

æ ¼å¼:
{
  "root": "ä¸»é¢˜",
  "children": [
    {
      "node": "åˆ†æ”¯1",
      "children": [
        {"node": "å­åˆ†æ”¯1"},
        {"node": "å­åˆ†æ”¯2"}
      ]
    }
  ]
}
```

#### Day 8-10: ä¾§æ é›†æˆ
```typescript
// æ›´æ–° ai-chat-sidebar.tsx
// æ·»åŠ "æ€ç»´å¯¼å›¾"æ¨¡å¼é€‰æ‹©
const AI_ASSISTANT_MODES = {
  text_to_flowchart: {...},
  text_to_mindmap: {...},     // æ–°å¢
  image_to_flowchart: {...}
};
```

#### Day 11-14: æ•°æ®æŒä¹…åŒ–ä¸æµ‹è¯•
- å†™å…¥ç°æœ‰ `flowcharts` è¡¨
- åŸºç¡€ç¼–è¾‘åŠŸèƒ½ (å¢åˆ æ”¹èŠ‚ç‚¹)
- ç«¯åˆ°ç«¯æµ‹è¯•

### äº¤ä»˜ç‰©
- âœ… ç”¨æˆ·å¯ä»¥ç”Ÿæˆæ€ç»´å¯¼å›¾
- âœ… åŸºç¡€ç¼–è¾‘èƒ½åŠ›
- âœ… æ•°æ®ä¿å­˜ä¸è¯»å–
- âœ… ç”ŸæˆæˆåŠŸç‡ â‰¥80%

---

## âš ï¸ é£é™©ä¸åº”å¯¹

### æŠ€æœ¯é£é™©

| é£é™© | åº”å¯¹ç­–ç•¥ |
|------|----------|
| mind-elixirä¸é€‚åˆå¤æ‚åœºæ™¯ | æå‰PoCæµ‹è¯•ï¼Œå‡†å¤‡å¤‡é€‰åº“ (reactflow) |
| ç¡¬ç¼–ç å¯¼è‡´åç»­é‡æ„å›°éš¾ | ä¿æŒæ¨¡å—åŒ–è®¾è®¡ï¼Œé‡æ„æ—¶è¿ç§»æˆæœ¬å¯æ§ |
| æ€§èƒ½é—®é¢˜ | é™åˆ¶èŠ‚ç‚¹æ•°é‡ (é»˜è®¤120)ï¼Œè™šæ‹ŸåŒ–æ¸²æŸ“ |

### äº§å“é£é™©

| é£é™© | åº”å¯¹ç­–ç•¥ |
|------|----------|
| ç”¨æˆ·ä¸æ¥å—å¤šDisplay | A/Bæµ‹è¯•ï¼Œæ”¶é›†åé¦ˆï¼Œå¿«é€Ÿè¿­ä»£ |
| æ€ç»´å¯¼å›¾ä»·å€¼ä¸æ˜ | å‡†å¤‡ä½¿ç”¨åœºæ™¯ (å­¦ä¹ ç¬”è®°ã€çŸ¥è¯†æ¢³ç†) |
| å­¦ä¹ æˆæœ¬é«˜ | æ¸è¿›å¼å¼•å¯¼ï¼Œé»˜è®¤ä¿æŒæµç¨‹å›¾æ¨¡å¼ |

### æ•°æ®è¿ç§»é£é™©

| é£é™© | åº”å¯¹ç­–ç•¥ |
|------|----------|
| è¿ç§»å¤±è´¥ | åŒå†™+ç°åº¦åˆ‡æ¢+å›æ»šæœºåˆ¶ |
| æ•°æ®ä¸ä¸€è‡´ | è‡ªåŠ¨åŒ–éªŒè¯è„šæœ¬ |
| APIæ€§èƒ½ä¸‹é™ | ç›‘æ§å“åº”æ—¶é—´ï¼ŒåŠæ—¶ä¼˜åŒ– |

---

## ğŸ“ˆ æˆåŠŸæŒ‡æ ‡

### Week 1-2 æˆåŠŸæ ‡å‡†
- [x] æ€ç»´å¯¼å›¾ç”ŸæˆæˆåŠŸç‡ â‰¥80%
- [x] å“åº”æ—¶é—´ <5ç§’
- [x] åŸºç¡€ç¼–è¾‘æ“ä½œæµç•…
- [x] æ•°æ®æŒä¹…åŒ–æ­£å¸¸

### Week 3-4 æˆåŠŸæ ‡å‡†
- [x] æ–°è€æ•°æ®è¯»å†™100%å…¼å®¹
- [x] è¿ç§»0æ•°æ®ä¸¢å¤±
- [x] APIå“åº”æ—¶é—´æ— æ˜æ˜¾ä¸‹é™

### Week 5-6 æˆåŠŸæ ‡å‡†
- [x] æ–°Displayçƒ­æ’æ‹”æ— é—®é¢˜
- [x] åˆ‡æ¢Displayç±»å‹æµç•…
- [x] ä»£ç å¤ç”¨åº¦æå‡ â‰¥50%

### Week 7-8 æˆåŠŸæ ‡å‡†
- [x] ä¸Šä¸‹æ–‡å‘½ä¸­ç‡ â‰¥70%
- [x] Tokenæ§åˆ¶ä¸è¶…é™
- [x] ç”¨æˆ·ä½“éªŒæµç•…

### Week 9-10 æˆåŠŸæ ‡å‡†
- [x] æµ‹éªŒç”ŸæˆæˆåŠŸç‡ â‰¥80%
- [x] å­¦ä¹ é¢æ¿æ“ä½œæµç•…
- [x] è¿›åº¦æ•°æ®å‡†ç¡®

---

## ğŸ› ï¸ æŠ€æœ¯å€ºåŠ¡ä¸åç»­ä¼˜åŒ–

### å¿…é¡»å¤„ç† (Week 11+)
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡è¾¾åˆ°80%
- [ ] E2Eæµ‹è¯•è¦†ç›–æ ¸å¿ƒæµç¨‹
- [ ] æ€§èƒ½ç›‘æ§ä¸å‘Šè­¦
- [ ] é”™è¯¯è¿½è¸ªç³»ç»Ÿæ¥å…¥

### å¯é€‰ä¼˜åŒ– (åç»­è¿­ä»£)
- [ ] WebWorkeræ¸²æŸ“ä¼˜åŒ–
- [ ] ä¸Šä¸‹æ–‡æ™ºèƒ½å‹ç¼©
- [ ] è·¨DisplayçŸ¥è¯†å›¾è°±
- [ ] å¤šæ¨¡å‹å¹¶è¡Œè°ƒç”¨

---

## ğŸ’¡ å¿«é€Ÿå¼€å§‹æ¸…å•

### ç¯å¢ƒå‡†å¤‡
```bash
# 1. ç¡®ä¿Node.js â‰¥20
node --version

# 2. å®‰è£…ä¾èµ–
pnpm install

# 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
pnpm dev

# 4. è®¿é—® http://localhost:3000
```

### ç¬¬ä¸€å‘¨ä»»åŠ¡åˆ†è§£
```bash
Day 1:
â”œâ”€ å®‰è£…mind-elixiråº“
â”œâ”€ åˆ›å»ºMindMapDisplayç»„ä»¶
â””â”€ éªŒè¯åŸºç¡€æ¸²æŸ“

Day 2-3:
â”œâ”€ å®ç°ç®€å•JSON â†’ æ€ç»´å¯¼å›¾è½¬æ¢
â”œâ”€ æµ‹è¯•æ‹–æ‹½ã€ç¼©æ”¾ç­‰åŸºç¡€åŠŸèƒ½
â””â”€ ç¡®å®šæ•°æ®ç»“æ„

Day 4-5:
â”œâ”€ åˆ›å»º /api/ai/chat/mindmap è·¯ç”±
â”œâ”€ å‚è€ƒflowchartè·¯ç”±å®ç°
â””â”€ Promptæ¨¡æ¿è°ƒä¼˜

Day 6-7:
â”œâ”€ é›†æˆåˆ°ä¾§æ  (AIæ¨¡å¼åˆ‡æ¢)
â”œâ”€ æµ‹è¯•AIç”Ÿæˆæµç¨‹
â””â”€ ä¿®å¤bug

Day 8-10:
â”œâ”€ æ•°æ®æŒä¹…åŒ–
â”œâ”€ åŸºç¡€ç¼–è¾‘åŠŸèƒ½
â””â”€ ç«¯åˆ°ç«¯æµ‹è¯•
```

---

## ğŸ“ éœ€è¦ç¡®è®¤çš„é—®é¢˜

åœ¨å¼€å§‹å®æ–½å‰ï¼Œè¯·ç¡®è®¤:

1. **mind-elixiråº“é€‰å‹**æ˜¯å¦æ»¡æ„ï¼Ÿæ˜¯å¦éœ€è¦æˆ‘å…ˆåšä¸€ä¸ªPoCéªŒè¯ï¼Ÿ
2. **æ•°æ®åº“æ¿€è¿›é‡æ„**çš„æ—¶é—´çª—å£æ˜¯å¦åˆé€‚ï¼Ÿæ˜¯å¦ä¼šå½±å“ç°æœ‰ç”¨æˆ·ï¼Ÿ
3. **é˜¶æ®µ0 (æµç¨‹å›¾é“¾è·¯åŠ å›º)**æ˜¯å¦æœ‰å¿…é¡»ä¼˜å…ˆå¤„ç†çš„é—®é¢˜ï¼Ÿ
4. **æµ‹éªŒæ¨¡å—**çš„å­¦ä¹ ç®—æ³•æ˜¯å¦éœ€è¦æˆ‘è¯¦ç»†è®¾è®¡ï¼Ÿ

---

## ğŸ“š å‚è€ƒèµ„æ–™

### æ ¸å¿ƒæ–‡æ¡£
- `vilearning-äº§å“éœ€æ±‚æ–‡æ¡£-ç²¾å‡†å®æ–½æ–¹æ¡ˆ.md` - å®Œæ•´PRD
- `architecture_evolution.md` - æ¶æ„æ¼”è¿›å›¾
- `database_migration_flow.md` - æ•°æ®åº“è¿ç§»è·¯å¾„
- `display_registry_workflow.md` - DisplayRegistryåŸç†
- `context_engine_workflow.md` - ä¸Šä¸‹æ–‡å·¥ç¨‹æµç¨‹

### ä»£ç ä½ç½®
- å½“å‰æµç¨‹å›¾å®ç°: `src/app/api/ai/chat/flowchart/route.ts`
- ä¾§æ ç»„ä»¶: `src/components/canvas/ai-chat-sidebar.tsx`
- ç™½æ¿ç»„ä»¶: `src/components/canvas/excalidraw-wrapper.tsx`
- Mermaidè½¬æ¢: `src/lib/mermaid-converter.ts`

---

**æ€»ç»“**: æœ¬æ–¹æ¡ˆé‡‡ç”¨"å…ˆéªŒè¯ï¼Œåé‡æ„"çš„ç­–ç•¥ï¼Œ10å‘¨å†…å®Œæˆå¤šDisplayå¹³å°çš„æ ¸å¿ƒåŠŸèƒ½ã€‚å…³é”®æˆåŠŸå› ç´ æ˜¯å¿«é€Ÿè¿­ä»£ + ä¿æŒæ¨¡å—åŒ–è®¾è®¡ï¼Œç¡®ä¿æ—¢èƒ½å¿«é€Ÿå‡ºæˆæœï¼Œåˆä¸ºé•¿æœŸç»´æŠ¤å¥ å®šåŸºç¡€ã€‚

**ä¸‹ä¸€æ­¥**: ç¡®è®¤æŠ€æœ¯é€‰å‹ â†’ å¯åŠ¨Week 1ä»»åŠ¡ â†’ æ¯å‘¨æœ«éªŒæ”¶è¿›å±• â†’ åŠæ—¶è°ƒæ•´ç­–ç•¥
